<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container my-3">
    <div class="container-fluid">
        <div class="row">
            <div>
                <form th:action="@{/image/upload}" method="post" id="img-form" enctype="multipart/form-data">
                    <div class="my-3  d-flex justify-content-center align-content-center">
                        <div style="position: relative; width: 12rem; height: 12rem;" id = "image_container">
                            <img id = "none_user_img" th:if="${myphoto}==null" th:src="@{/img/noneuser.png}" onerror="imageUploading();"
                                 class="shadow rounded-circle text-center"
                                 style="position: absolute; top: 0; left: 0; transform: translate(50,50); width: 100%; height: 100%; object-fit: cover; margin: auto">
                            <img id = "user_img" th:unless="${myphoto}==null" th:src="${myphoto}"  onerror="imageUploading();"
                            class="shadow rounded-circle text-center"
                            style="position: absolute; top: 0; left: 0; transform: translate(50,50); width: 100%; height: 100%; object-fit: cover; margin: auto">
                        </div>
                    </div>

                    <div class="my-3 mt-5 d-flex justify-item-center align-items-center justify-content-center align-content-center">
                        <input type="file" accept="image/*" class="visually-hidden" id="img-input" name="img-input" onchange="readURL(this);">
                        <button type="button" id="img-upload-btn" name="img-upload-btn" class="btn btn-primary mx-3 w-25" th:text="@{이미지 업로드}"></button>
                    </div>

                    <div class="my-3 d-flex justify-item-center align-items-center justify-content-center align-content-center">
                        <a href="/member/pw_modify" class="btn btn-primary mx-3 w-25">비밀번호 변경하기</a>
                    </div>

                    <div class="my-3 d-flex justify-item-center align-items-center justify-content-center align-content-center">
                        <a href="/member/mypage_question" class="btn btn-primary mx-3 w-25">내가 쓴 글</a>
                    </div>

                    <div class="my-3 d-flex justify-item-center align-items-center justify-content-center align-content-center">
                        <a href="/member/mypage_answer" class="btn btn-primary mx-3 w-25">내가 쓴 답변</a>
                    </div>
                </form>
            </div>

        </div>
    </div>
</div>
<script layout:fragment="script" type='text/javascript'>

    debugger;
    var img_btn = document.getElementById("img-upload-btn");
    img_btn.addEventListener('click', function () {
        debugger;
        document.getElementById('img-input').click();
    });


    function readURL(input)
    {
        debugger;
        if(input.files && input.files[0])
        {
            const reader = new FileReader();
            reader.addEventListener('load',function (e)
            {
                debugger;
                const str = e.target.result.toString();

                var img = document.getElementById('user_img');
                img.setAttribute('src', str);
            });
            reader.readAsDataURL(input.files[0]);

            document.getElementById('img-form').submit();
        }
    }

    function imageUploading() {
        debugger;
    }

</script>
</html>